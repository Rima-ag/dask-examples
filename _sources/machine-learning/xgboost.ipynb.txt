{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Scale XGBoost\n",
    "=============\n",
    "\n",
    "Dask and XGBoost can work together to train gradient boosted trees in parallel. This notebook shows how to use Dask and XGBoost together.\n",
    "\n",
    "XGBoost provides a powerful prediction framework, and it works well in practice. It wins Kaggle contests and is popular in industry because it has good performance and can be easily interpreted (i.e., it's easy to find the important features from a XGBoost model).\n",
    "\n",
    "<img src=\"http://dask.readthedocs.io/en/latest/_images/dask_horizontal.svg\" width=\"30%\" alt=\"Dask logo\"> <img src=\"https://raw.githubusercontent.com/dmlc/dmlc.github.io/master/img/logo-m/xgboost.png\" width=\"25%\" alt=\"Dask logo\">"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Setup Dask\n",
    "We setup a Dask client, which provides performance and progress metrics via the dashboard.\n",
    "\n",
    "You can view the dashboard by clicking the link after running the cell."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:26:18.503400Z",
     "iopub.status.busy": "2022-05-11T21:26:18.503023Z",
     "iopub.status.idle": "2022-05-11T21:26:21.433019Z",
     "shell.execute_reply": "2022-05-11T21:26:21.432512Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "    <div style=\"width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;\"> </div>\n",
       "    <div style=\"margin-left: 48px;\">\n",
       "        <h3 style=\"margin-bottom: 0px;\">Client</h3>\n",
       "        <p style=\"color: #9D9D9D; margin-bottom: 0px;\">Client-ff23603b-d170-11ec-a684-000d3a9cbfb9</p>\n",
       "        <table style=\"width: 100%; text-align: left;\">\n",
       "\n",
       "        <tr>\n",
       "        \n",
       "            <td style=\"text-align: left;\"><strong>Connection method:</strong> Cluster object</td>\n",
       "            <td style=\"text-align: left;\"><strong>Cluster type:</strong> distributed.LocalCluster</td>\n",
       "        \n",
       "        </tr>\n",
       "\n",
       "        \n",
       "            <tr>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:8787/status\" target=\"_blank\">http://127.0.0.1:8787/status</a>\n",
       "                </td>\n",
       "                <td style=\"text-align: left;\"></td>\n",
       "            </tr>\n",
       "        \n",
       "\n",
       "        </table>\n",
       "\n",
       "        \n",
       "            <details>\n",
       "            <summary style=\"margin-bottom: 20px;\"><h3 style=\"display: inline;\">Cluster Info</h3></summary>\n",
       "            <div class=\"jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output\">\n",
       "    <div style=\"width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;\">\n",
       "    </div>\n",
       "    <div style=\"margin-left: 48px;\">\n",
       "        <h3 style=\"margin-bottom: 0px; margin-top: 0px;\">LocalCluster</h3>\n",
       "        <p style=\"color: #9D9D9D; margin-bottom: 0px;\">064b6d5c</p>\n",
       "        <table style=\"width: 100%; text-align: left;\">\n",
       "            <tr>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Dashboard:</strong> <a href=\"http://127.0.0.1:8787/status\" target=\"_blank\">http://127.0.0.1:8787/status</a>\n",
       "                </td>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Workers:</strong> 4\n",
       "                </td>\n",
       "            </tr>\n",
       "            <tr>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Total threads:</strong> 4\n",
       "                </td>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Total memory:</strong> 6.78 GiB\n",
       "                </td>\n",
       "            </tr>\n",
       "            \n",
       "            <tr>\n",
       "    <td style=\"text-align: left;\"><strong>Status:</strong> running</td>\n",
       "    <td style=\"text-align: left;\"><strong>Using processes:</strong> True</td>\n",
       "</tr>\n",
       "\n",
       "            \n",
       "        </table>\n",
       "\n",
       "        <details>\n",
       "            <summary style=\"margin-bottom: 20px;\">\n",
       "                <h3 style=\"display: inline;\">Scheduler Info</h3>\n",
       "            </summary>\n",
       "\n",
       "            <div style=\"\">\n",
       "    <div>\n",
       "        <div style=\"width: 24px; height: 24px; background-color: #FFF7E5; border: 3px solid #FF6132; border-radius: 5px; position: absolute;\"> </div>\n",
       "        <div style=\"margin-left: 48px;\">\n",
       "            <h3 style=\"margin-bottom: 0px;\">Scheduler</h3>\n",
       "            <p style=\"color: #9D9D9D; margin-bottom: 0px;\">Scheduler-f97a2d92-777c-4ff3-a494-84234e9ae23e</p>\n",
       "            <table style=\"width: 100%; text-align: left;\">\n",
       "                <tr>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Comm:</strong> tcp://127.0.0.1:38937\n",
       "                    </td>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Workers:</strong> 4\n",
       "                    </td>\n",
       "                </tr>\n",
       "                <tr>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Dashboard:</strong> <a href=\"http://127.0.0.1:8787/status\" target=\"_blank\">http://127.0.0.1:8787/status</a>\n",
       "                    </td>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Total threads:</strong> 4\n",
       "                    </td>\n",
       "                </tr>\n",
       "                <tr>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Started:</strong> Just now\n",
       "                    </td>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Total memory:</strong> 6.78 GiB\n",
       "                    </td>\n",
       "                </tr>\n",
       "            </table>\n",
       "        </div>\n",
       "    </div>\n",
       "\n",
       "    <details style=\"margin-left: 48px;\">\n",
       "        <summary style=\"margin-bottom: 20px;\">\n",
       "            <h3 style=\"display: inline;\">Workers</h3>\n",
       "        </summary>\n",
       "\n",
       "        \n",
       "        <div style=\"margin-bottom: 20px;\">\n",
       "            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n",
       "            <div style=\"margin-left: 48px;\">\n",
       "            <details>\n",
       "                <summary>\n",
       "                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 0</h4>\n",
       "                </summary>\n",
       "                <table style=\"width: 100%; text-align: left;\">\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Comm: </strong> tcp://127.0.0.1:44559\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Total threads: </strong> 1\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:33547/status\" target=\"_blank\">http://127.0.0.1:33547/status</a>\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Memory: </strong> 1.70 GiB\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Nanny: </strong> tcp://127.0.0.1:37487\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\"></td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td colspan=\"2\" style=\"text-align: left;\">\n",
       "                            <strong>Local directory: </strong> /home/runner/work/dask-examples/dask-examples/machine-learning/dask-worker-space/worker-wqa24dig\n",
       "                        </td>\n",
       "                    </tr>\n",
       "\n",
       "                    \n",
       "\n",
       "                    \n",
       "\n",
       "                </table>\n",
       "            </details>\n",
       "            </div>\n",
       "        </div>\n",
       "        \n",
       "        <div style=\"margin-bottom: 20px;\">\n",
       "            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n",
       "            <div style=\"margin-left: 48px;\">\n",
       "            <details>\n",
       "                <summary>\n",
       "                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 1</h4>\n",
       "                </summary>\n",
       "                <table style=\"width: 100%; text-align: left;\">\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Comm: </strong> tcp://127.0.0.1:42311\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Total threads: </strong> 1\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:34783/status\" target=\"_blank\">http://127.0.0.1:34783/status</a>\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Memory: </strong> 1.70 GiB\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Nanny: </strong> tcp://127.0.0.1:46841\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\"></td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td colspan=\"2\" style=\"text-align: left;\">\n",
       "                            <strong>Local directory: </strong> /home/runner/work/dask-examples/dask-examples/machine-learning/dask-worker-space/worker-wbvrpc58\n",
       "                        </td>\n",
       "                    </tr>\n",
       "\n",
       "                    \n",
       "\n",
       "                    \n",
       "\n",
       "                </table>\n",
       "            </details>\n",
       "            </div>\n",
       "        </div>\n",
       "        \n",
       "        <div style=\"margin-bottom: 20px;\">\n",
       "            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n",
       "            <div style=\"margin-left: 48px;\">\n",
       "            <details>\n",
       "                <summary>\n",
       "                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 2</h4>\n",
       "                </summary>\n",
       "                <table style=\"width: 100%; text-align: left;\">\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Comm: </strong> tcp://127.0.0.1:40403\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Total threads: </strong> 1\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:45307/status\" target=\"_blank\">http://127.0.0.1:45307/status</a>\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Memory: </strong> 1.70 GiB\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Nanny: </strong> tcp://127.0.0.1:42755\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\"></td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td colspan=\"2\" style=\"text-align: left;\">\n",
       "                            <strong>Local directory: </strong> /home/runner/work/dask-examples/dask-examples/machine-learning/dask-worker-space/worker-dkftur2l\n",
       "                        </td>\n",
       "                    </tr>\n",
       "\n",
       "                    \n",
       "\n",
       "                    \n",
       "\n",
       "                </table>\n",
       "            </details>\n",
       "            </div>\n",
       "        </div>\n",
       "        \n",
       "        <div style=\"margin-bottom: 20px;\">\n",
       "            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n",
       "            <div style=\"margin-left: 48px;\">\n",
       "            <details>\n",
       "                <summary>\n",
       "                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 3</h4>\n",
       "                </summary>\n",
       "                <table style=\"width: 100%; text-align: left;\">\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Comm: </strong> tcp://127.0.0.1:34861\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Total threads: </strong> 1\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:42341/status\" target=\"_blank\">http://127.0.0.1:42341/status</a>\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Memory: </strong> 1.70 GiB\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Nanny: </strong> tcp://127.0.0.1:35443\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\"></td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td colspan=\"2\" style=\"text-align: left;\">\n",
       "                            <strong>Local directory: </strong> /home/runner/work/dask-examples/dask-examples/machine-learning/dask-worker-space/worker-yxtqqw15\n",
       "                        </td>\n",
       "                    </tr>\n",
       "\n",
       "                    \n",
       "\n",
       "                    \n",
       "\n",
       "                </table>\n",
       "            </details>\n",
       "            </div>\n",
       "        </div>\n",
       "        \n",
       "\n",
       "    </details>\n",
       "</div>\n",
       "\n",
       "        </details>\n",
       "    </div>\n",
       "</div>\n",
       "            </details>\n",
       "        \n",
       "\n",
       "    </div>\n",
       "</div>"
      ],
      "text/plain": [
       "<Client: 'tcp://127.0.0.1:38937' processes=4 threads=4, memory=6.78 GiB>"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from dask.distributed import Client\n",
    "\n",
    "client = Client(n_workers=4, threads_per_worker=1)\n",
    "client"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create data"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "First we create a bunch of synthetic data, with 100,000 examples and 20 features."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:26:21.436505Z",
     "iopub.status.busy": "2022-05-11T21:26:21.436325Z",
     "iopub.status.idle": "2022-05-11T21:26:22.116629Z",
     "shell.execute_reply": "2022-05-11T21:26:22.116032Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/usr/share/miniconda3/envs/dask-examples/lib/python3.9/site-packages/dask/base.py:1283: UserWarning: Running on a single-machine scheduler when a distributed client is active might lead to unexpected results.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <tr>\n",
       "        <td>\n",
       "            <table>\n",
       "                <thead>\n",
       "                    <tr>\n",
       "                        <td> </td>\n",
       "                        <th> Array </th>\n",
       "                        <th> Chunk </th>\n",
       "                    </tr>\n",
       "                </thead>\n",
       "                <tbody>\n",
       "                    \n",
       "                    <tr>\n",
       "                        <th> Bytes </th>\n",
       "                        <td> 15.26 MiB </td>\n",
       "                        <td> 156.25 kiB </td>\n",
       "                    </tr>\n",
       "                    \n",
       "                    <tr>\n",
       "                        <th> Shape </th>\n",
       "                        <td> (100000, 20) </td>\n",
       "                        <td> (1000, 20) </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <th> Count </th>\n",
       "                        <td> 100 Tasks </td>\n",
       "                        <td> 100 Chunks </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                    <th> Type </th>\n",
       "                    <td> float64 </td>\n",
       "                    <td> numpy.ndarray </td>\n",
       "                    </tr>\n",
       "                </tbody>\n",
       "            </table>\n",
       "        </td>\n",
       "        <td>\n",
       "        <svg width=\"75\" height=\"170\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"25\" y2=\"0\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"0\" y1=\"6\" x2=\"25\" y2=\"6\" />\n",
       "  <line x1=\"0\" y1=\"12\" x2=\"25\" y2=\"12\" />\n",
       "  <line x1=\"0\" y1=\"18\" x2=\"25\" y2=\"18\" />\n",
       "  <line x1=\"0\" y1=\"25\" x2=\"25\" y2=\"25\" />\n",
       "  <line x1=\"0\" y1=\"31\" x2=\"25\" y2=\"31\" />\n",
       "  <line x1=\"0\" y1=\"37\" x2=\"25\" y2=\"37\" />\n",
       "  <line x1=\"0\" y1=\"43\" x2=\"25\" y2=\"43\" />\n",
       "  <line x1=\"0\" y1=\"50\" x2=\"25\" y2=\"50\" />\n",
       "  <line x1=\"0\" y1=\"56\" x2=\"25\" y2=\"56\" />\n",
       "  <line x1=\"0\" y1=\"62\" x2=\"25\" y2=\"62\" />\n",
       "  <line x1=\"0\" y1=\"68\" x2=\"25\" y2=\"68\" />\n",
       "  <line x1=\"0\" y1=\"75\" x2=\"25\" y2=\"75\" />\n",
       "  <line x1=\"0\" y1=\"81\" x2=\"25\" y2=\"81\" />\n",
       "  <line x1=\"0\" y1=\"87\" x2=\"25\" y2=\"87\" />\n",
       "  <line x1=\"0\" y1=\"93\" x2=\"25\" y2=\"93\" />\n",
       "  <line x1=\"0\" y1=\"100\" x2=\"25\" y2=\"100\" />\n",
       "  <line x1=\"0\" y1=\"106\" x2=\"25\" y2=\"106\" />\n",
       "  <line x1=\"0\" y1=\"112\" x2=\"25\" y2=\"112\" />\n",
       "  <line x1=\"0\" y1=\"120\" x2=\"25\" y2=\"120\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"120\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"25\" y1=\"0\" x2=\"25\" y2=\"120\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"0.0,0.0 25.412616514582485,0.0 25.412616514582485,120.0 0.0,120.0\" style=\"fill:#8B4903A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Text -->\n",
       "  <text x=\"12.706308\" y=\"140.000000\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >20</text>\n",
       "  <text x=\"45.412617\" y=\"60.000000\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(-90,45.412617,60.000000)\">100000</text>\n",
       "</svg>\n",
       "        </td>\n",
       "    </tr>\n",
       "</table>"
      ],
      "text/plain": [
       "dask.array<normal, shape=(100000, 20), dtype=float64, chunksize=(1000, 20), chunktype=numpy.ndarray>"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from dask_ml.datasets import make_classification\n",
    "\n",
    "X, y = make_classification(n_samples=100000, n_features=20,\n",
    "                           chunks=1000, n_informative=4,\n",
    "                           random_state=0)\n",
    "X"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Dask-XGBoost works with both arrays and dataframes. For more information on creating dask arrays and dataframes from real data, see documentation on [Dask arrays](https://dask.pydata.org/en/latest/array-creation.html) or [Dask dataframes](https://dask.pydata.org/en/latest/dataframe-create.html)."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Split data for training and testing\n",
    "We split our dataset into training and testing data to aid evaluation by making sure we have a fair test:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:26:22.119820Z",
     "iopub.status.busy": "2022-05-11T21:26:22.119362Z",
     "iopub.status.idle": "2022-05-11T21:26:22.308937Z",
     "shell.execute_reply": "2022-05-11T21:26:22.308027Z"
    }
   },
   "outputs": [],
   "source": [
    "from dask_ml.model_selection import train_test_split\n",
    "\n",
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.15)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now, let's try to do something with this data using [dask-xgboost][dxgb].\n",
    "\n",
    "[dxgb]:https://github.com/dask/dask-xgboost"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Train Dask-XGBoost"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:26:22.313971Z",
     "iopub.status.busy": "2022-05-11T21:26:22.312807Z",
     "iopub.status.idle": "2022-05-11T21:26:22.354537Z",
     "shell.execute_reply": "2022-05-11T21:26:22.354086Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/usr/share/miniconda3/envs/dask-examples/lib/python3.9/site-packages/xgboost/compat.py:36: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.\n",
      "  from pandas import MultiIndex, Int64Index\n"
     ]
    }
   ],
   "source": [
    "import dask\n",
    "import xgboost\n",
    "import dask_xgboost"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "dask-xgboost is a small wrapper around xgboost. Dask sets XGBoost up, gives XGBoost data and lets XGBoost do it's training in the background using all the workers Dask has available."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let's do some training:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:26:22.357518Z",
     "iopub.status.busy": "2022-05-11T21:26:22.357221Z",
     "iopub.status.idle": "2022-05-11T21:26:27.365505Z",
     "shell.execute_reply": "2022-05-11T21:26:27.364966Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Exception in thread Thread-4:\n",
      "Traceback (most recent call last):\n",
      "  File \"/usr/share/miniconda3/envs/dask-examples/lib/python3.9/threading.py\", line 973, in _bootstrap_inner\n",
      "    self.run()\n",
      "  File \"/usr/share/miniconda3/envs/dask-examples/lib/python3.9/threading.py\", line 910, in run\n",
      "    self._target(*self._args, **self._kwargs)\n",
      "  File \"/usr/share/miniconda3/envs/dask-examples/lib/python3.9/site-packages/dask_xgboost/tracker.py\", line 365, in join\n",
      "    while self.thread.isAlive():\n",
      "AttributeError: 'Thread' object has no attribute 'isAlive'\n"
     ]
    }
   ],
   "source": [
    "params = {'objective': 'binary:logistic',\n",
    "          'max_depth': 4, 'eta': 0.01, 'subsample': 0.5, \n",
    "          'min_child_weight': 0.5}\n",
    "\n",
    "bst = dask_xgboost.train(client, params, X_train, y_train, num_boost_round=10)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Visualize results"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The `bst` object is a regular `xgboost.Booster` object. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:26:27.374762Z",
     "iopub.status.busy": "2022-05-11T21:26:27.374222Z",
     "iopub.status.idle": "2022-05-11T21:26:27.378419Z",
     "shell.execute_reply": "2022-05-11T21:26:27.377849Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<xgboost.core.Booster at 0x7f03f404eaf0>"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "bst"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This means all the methods mentioned in the [XGBoost documentation][2] are available. We show two examples to expand on this, but these examples are of XGBoost instead of Dask.\n",
    "\n",
    "[2]:https://xgboost.readthedocs.io/en/latest/python/python_intro.html#"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Plot feature importance"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:26:27.381041Z",
     "iopub.status.busy": "2022-05-11T21:26:27.380608Z",
     "iopub.status.idle": "2022-05-11T21:26:28.049095Z",
     "shell.execute_reply": "2022-05-11T21:26:28.048526Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "ax = xgboost.plot_importance(bst, height=0.8, max_num_features=9)\n",
    "ax.grid(False, axis=\"y\")\n",
    "ax.set_title('Estimated feature importance')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We specified that only 4 features were informative while creating our data, and only 3 features show up as important."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Plot the Receiver Operating Characteristic curve\n",
    "We can use a fancier metric to determine how well our classifier is doing by plotting the [Receiver Operating Characteristic (ROC) curve](https://en.wikipedia.org/wiki/Receiver_operating_characteristic):"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:26:28.052590Z",
     "iopub.status.busy": "2022-05-11T21:26:28.052247Z",
     "iopub.status.idle": "2022-05-11T21:26:28.116601Z",
     "shell.execute_reply": "2022-05-11T21:26:28.116116Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[21:26:28] WARNING: /home/conda/feedstock_root/build_artifacts/xgboost-split_1645117766796/work/src/learner.cc:1264: Empty dataset at worker: 0\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<table>\n",
       "    <tr>\n",
       "        <td>\n",
       "            <table>\n",
       "                <thead>\n",
       "                    <tr>\n",
       "                        <td> </td>\n",
       "                        <th> Array </th>\n",
       "                        <th> Chunk </th>\n",
       "                    </tr>\n",
       "                </thead>\n",
       "                <tbody>\n",
       "                    \n",
       "                    <tr>\n",
       "                        <th> Bytes </th>\n",
       "                        <td> 58.59 kiB </td>\n",
       "                        <td> 600 B </td>\n",
       "                    </tr>\n",
       "                    \n",
       "                    <tr>\n",
       "                        <th> Shape </th>\n",
       "                        <td> (15000,) </td>\n",
       "                        <td> (150,) </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <th> Count </th>\n",
       "                        <td> 100 Tasks </td>\n",
       "                        <td> 100 Chunks </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                    <th> Type </th>\n",
       "                    <td> float32 </td>\n",
       "                    <td> numpy.ndarray </td>\n",
       "                    </tr>\n",
       "                </tbody>\n",
       "            </table>\n",
       "        </td>\n",
       "        <td>\n",
       "        <svg width=\"170\" height=\"75\" style=\"stroke:rgb(0,0,0);stroke-width:1\" >\n",
       "\n",
       "  <!-- Horizontal lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"120\" y2=\"0\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"0\" y1=\"25\" x2=\"120\" y2=\"25\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Vertical lines -->\n",
       "  <line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"25\" style=\"stroke-width:2\" />\n",
       "  <line x1=\"6\" y1=\"0\" x2=\"6\" y2=\"25\" />\n",
       "  <line x1=\"12\" y1=\"0\" x2=\"12\" y2=\"25\" />\n",
       "  <line x1=\"18\" y1=\"0\" x2=\"18\" y2=\"25\" />\n",
       "  <line x1=\"25\" y1=\"0\" x2=\"25\" y2=\"25\" />\n",
       "  <line x1=\"31\" y1=\"0\" x2=\"31\" y2=\"25\" />\n",
       "  <line x1=\"37\" y1=\"0\" x2=\"37\" y2=\"25\" />\n",
       "  <line x1=\"43\" y1=\"0\" x2=\"43\" y2=\"25\" />\n",
       "  <line x1=\"50\" y1=\"0\" x2=\"50\" y2=\"25\" />\n",
       "  <line x1=\"56\" y1=\"0\" x2=\"56\" y2=\"25\" />\n",
       "  <line x1=\"62\" y1=\"0\" x2=\"62\" y2=\"25\" />\n",
       "  <line x1=\"68\" y1=\"0\" x2=\"68\" y2=\"25\" />\n",
       "  <line x1=\"75\" y1=\"0\" x2=\"75\" y2=\"25\" />\n",
       "  <line x1=\"81\" y1=\"0\" x2=\"81\" y2=\"25\" />\n",
       "  <line x1=\"87\" y1=\"0\" x2=\"87\" y2=\"25\" />\n",
       "  <line x1=\"93\" y1=\"0\" x2=\"93\" y2=\"25\" />\n",
       "  <line x1=\"100\" y1=\"0\" x2=\"100\" y2=\"25\" />\n",
       "  <line x1=\"106\" y1=\"0\" x2=\"106\" y2=\"25\" />\n",
       "  <line x1=\"112\" y1=\"0\" x2=\"112\" y2=\"25\" />\n",
       "  <line x1=\"120\" y1=\"0\" x2=\"120\" y2=\"25\" style=\"stroke-width:2\" />\n",
       "\n",
       "  <!-- Colored Rectangle -->\n",
       "  <polygon points=\"0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485\" style=\"fill:#8B4903A0;stroke-width:0\"/>\n",
       "\n",
       "  <!-- Text -->\n",
       "  <text x=\"60.000000\" y=\"45.412617\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" >15000</text>\n",
       "  <text x=\"140.000000\" y=\"12.706308\" font-size=\"1.0rem\" font-weight=\"100\" text-anchor=\"middle\" transform=\"rotate(0,140.000000,12.706308)\">1</text>\n",
       "</svg>\n",
       "        </td>\n",
       "    </tr>\n",
       "</table>"
      ],
      "text/plain": [
       "dask.array<_predict_part, shape=(15000,), dtype=float32, chunksize=(150,), chunktype=numpy.ndarray>"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_hat = dask_xgboost.predict(client, bst, X_test).persist()\n",
    "y_hat"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:26:28.120099Z",
     "iopub.status.busy": "2022-05-11T21:26:28.119798Z",
     "iopub.status.idle": "2022-05-11T21:26:30.044431Z",
     "shell.execute_reply": "2022-05-11T21:26:30.043848Z"
    }
   },
   "outputs": [],
   "source": [
    "from sklearn.metrics import roc_curve\n",
    "\n",
    "y_test, y_hat = dask.compute(y_test, y_hat)\n",
    "fpr, tpr, _ = roc_curve(y_test, y_hat)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:26:30.063327Z",
     "iopub.status.busy": "2022-05-11T21:26:30.058982Z",
     "iopub.status.idle": "2022-05-11T21:26:30.192160Z",
     "shell.execute_reply": "2022-05-11T21:26:30.191516Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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OR544IEMYzh3npCQEObNm8esWbNYtGgRefPmpU2bNp6eZVFRUZ7kpKrccccdvP3222mOtX37doYNG8bixYspXLgwd955Z7o9066kRFquXDnmzZvnWY+JiaFNmzaXvJ5x48YxcuTIi7Z///339OnT56LeSvHx8eTJk+eSx/OVnbGn+HFpDHM2HmTt3hNk1IcmT3goTSoXoX65gtQsFU2tUgWoVDQvYX7QntNX/vrrLzp37kzBggVZtGgRZcqUyfkgMlu56tQrEB42LVu2TMuXL69nz57V06dPa+XKlXXmzJmq6nr41K1bNx0+fLiqqq5cuVKrVq2qGzduVFXV5ORk/c9//nPR8TPa7/XXX9enn35aVVUnTJigrh+r6ty5c7Vbt25pjrNmzRpt0aKFVq9eXffu3auqqtOnT9emTZvqyZMnVVU1JiZGDxw4cFEMzZo1082bN6uq6s8//6zdu3dXVdX169drZGSkzp0796Lvxdq1a7VatWqe48XGxuqOHTt0xYoVWq9ePU1OTtb9+/driRIl9Isvvrj8NzoDsbGxWqlSJT1y5IgeOXJEK1WqpLGxsenuu2HDBq1YsaKmpKSke51z5sy5aHvdunU937PUfPX7FxefqG9NWafVnv/1kg+Gqj8/RW8atVA/mLlJF2+P1YTEZJ/E4q8WLFig0dHRCmjfvn01ISEh08fCHjb5l4YNG1K/fn3GjRvH7bffzsSJExkyZAgPP/wwycnJ3H777QwePBiAevXq8cEHHzBw4EBOnz6NiNCt28V1sRntd99999GrVy+aNm1K+/btM6wXqlOnDidPnqRs2bKULu2a2aVTp06sX7+eFi1aAK6HRd9++63nFvycbt26MW/ePKpVq0aXLl0YNWoU9erVo2bNmjRv3jzd89WuXZs33niDTp06kZKSQnh4OCNHjqR58+Y0bNiQOnXqUKVKFVq2bHnl3+gLFClShJdeeslTjfDyyy97Hjy9/PLLNG7cmJ49ewKuh0wDBgy46NZ/x44d7N69m9atW6fZfuDAAfLkyeP5nvlKfGIyC7ceZua6A0xbs5+jpxPTvB8icHW5QrSsWpRrqxajUcXC5InImX7q/mbevHl0796dU6dOMWDAAL755hvHHgQGRV/79evXc9VVVzkUUe6xb98+Bg0axMyZM50OJce9//77FChQwPMQMbXs+P07eCKej+dt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\n",
      "text/plain": [
       "<Figure size 360x360 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "from sklearn.metrics import auc\n",
    "\n",
    "fig, ax = plt.subplots(figsize=(5, 5))\n",
    "ax.plot(fpr, tpr, lw=3,\n",
    "        label='ROC Curve (area = {:.2f})'.format(auc(fpr, tpr)))\n",
    "ax.plot([0, 1], [0, 1], 'k--', lw=2)\n",
    "ax.set(\n",
    "    xlim=(0, 1),\n",
    "    ylim=(0, 1),\n",
    "    title=\"ROC Curve\",\n",
    "    xlabel=\"False Positive Rate\",\n",
    "    ylabel=\"True Positive Rate\",\n",
    ")\n",
    "ax.legend();\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This Receiver Operating Characteristic (ROC) curve tells how well our classifier is doing. We can tell it's doing well by how far it bends the upper-left. A perfect classifier would be in the upper-left corner, and a random classifier would follow the diagonal line.\n",
    "\n",
    "The area under this curve is `area = 0.76`. This tells us the probability that our classifier will predict correctly for a randomly chosen instance."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Learn more\n",
    "* Recorded screencast stepping through the real world example above:\n",
    "* A blogpost on dask-xgboost http://matthewrocklin.com/blog/work/2017/03/28/dask-xgboost\n",
    "* XGBoost documentation: https://xgboost.readthedocs.io/en/latest/python/python_intro.html#\n",
    "* Dask-XGBoost documentation: http://ml.dask.org/xgboost.html"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
