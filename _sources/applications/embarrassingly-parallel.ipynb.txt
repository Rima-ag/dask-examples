{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<img src=\"http://dask.readthedocs.io/en/latest/_images/dask_horizontal.svg\" \n",
    "     width=\"30%\" \n",
    "     align=right\n",
    "     alt=\"Dask logo\">\n",
    "\n",
    "# Embarrassingly parallel Workloads\n",
    "\n",
    "This notebook shows how to use Dask to parallelize embarrassingly parallel workloads where you want to apply one function to many pieces of data independently.  It will show three different ways of doing this with Dask:\n",
    "\n",
    "1. [dask.delayed](http://dask.pydata.org/en/latest/delayed.html) \n",
    "2. [concurrent.Futures](https://dask.pydata.org/en/latest/futures.html) \n",
    "3. [dask.bag](https://dask.pydata.org/en/latest/bag.html)\n",
    "\n",
    "This example focuses on using Dask for building large embarrassingly parallel computation as often seen in scientific communities and on High Performance Computing facilities, for example with Monte Carlo methods. This kind of simulation assume the following:\n",
    "\n",
    " - We have a function that runs a heavy computation given some parameters.\n",
    " - We need to compute this function on many different input parameters, each function call being independent.\n",
    " - We want to gather all the results in one place for further analysis."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Start Dask Client for Dashboard\n",
    "\n",
    "Starting the Dask Client will provide a dashboard which \n",
    "is useful to gain insight on the computation.  We will also need it for the\n",
    "Futures API part of this example. Moreover, as this kind of computation\n",
    "is often launched on super computer or in the Cloud, you will probably end\n",
    "up having to start a cluster and connect a client to scale.  See \n",
    "[dask-jobqueue](https://github.com/dask/dask-jobqueue),\n",
    "[dask-kubernetes](https://github.com/dask/dask-kubernetes) or \n",
    "[dask-yarn](https://github.com/dask/dask-yarn) for easy ways to achieve this\n",
    "on respectively an HPC, Cloud or Big Data infrastructure.\n",
    "\n",
    "The link to the dashboard will become visible when you create the client below.  We recommend having it open on one side of your screen while using your notebook on the other side.  This can take some effort to arrange your windows, but seeing them both at the same time is very useful when learning."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:19.884174Z",
     "iopub.status.busy": "2022-06-16T17:44:19.883633Z",
     "iopub.status.idle": "2022-06-16T17:44:21.798792Z",
     "shell.execute_reply": "2022-06-16T17:44:21.798322Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "    <div style=\"width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;\"> </div>\n",
       "    <div style=\"margin-left: 48px;\">\n",
       "        <h3 style=\"margin-bottom: 0px;\">Client</h3>\n",
       "        <p style=\"color: #9D9D9D; margin-bottom: 0px;\">Client-f383c32b-ed9b-11ec-9f50-000d3a01c323</p>\n",
       "        <table style=\"width: 100%; text-align: left;\">\n",
       "\n",
       "        <tr>\n",
       "        \n",
       "            <td style=\"text-align: left;\"><strong>Connection method:</strong> Cluster object</td>\n",
       "            <td style=\"text-align: left;\"><strong>Cluster type:</strong> distributed.LocalCluster</td>\n",
       "        \n",
       "        </tr>\n",
       "\n",
       "        \n",
       "            <tr>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:8787/status\" target=\"_blank\">http://127.0.0.1:8787/status</a>\n",
       "                </td>\n",
       "                <td style=\"text-align: left;\"></td>\n",
       "            </tr>\n",
       "        \n",
       "\n",
       "        </table>\n",
       "\n",
       "        \n",
       "            <details>\n",
       "            <summary style=\"margin-bottom: 20px;\"><h3 style=\"display: inline;\">Cluster Info</h3></summary>\n",
       "            <div class=\"jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output\">\n",
       "    <div style=\"width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;\">\n",
       "    </div>\n",
       "    <div style=\"margin-left: 48px;\">\n",
       "        <h3 style=\"margin-bottom: 0px; margin-top: 0px;\">LocalCluster</h3>\n",
       "        <p style=\"color: #9D9D9D; margin-bottom: 0px;\">b45b2bdc</p>\n",
       "        <table style=\"width: 100%; text-align: left;\">\n",
       "            <tr>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Dashboard:</strong> <a href=\"http://127.0.0.1:8787/status\" target=\"_blank\">http://127.0.0.1:8787/status</a>\n",
       "                </td>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Workers:</strong> 1\n",
       "                </td>\n",
       "            </tr>\n",
       "            <tr>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Total threads:</strong> 4\n",
       "                </td>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Total memory:</strong> 6.78 GiB\n",
       "                </td>\n",
       "            </tr>\n",
       "            \n",
       "            <tr>\n",
       "    <td style=\"text-align: left;\"><strong>Status:</strong> running</td>\n",
       "    <td style=\"text-align: left;\"><strong>Using processes:</strong> True</td>\n",
       "</tr>\n",
       "\n",
       "            \n",
       "        </table>\n",
       "\n",
       "        <details>\n",
       "            <summary style=\"margin-bottom: 20px;\">\n",
       "                <h3 style=\"display: inline;\">Scheduler Info</h3>\n",
       "            </summary>\n",
       "\n",
       "            <div style=\"\">\n",
       "    <div>\n",
       "        <div style=\"width: 24px; height: 24px; background-color: #FFF7E5; border: 3px solid #FF6132; border-radius: 5px; position: absolute;\"> </div>\n",
       "        <div style=\"margin-left: 48px;\">\n",
       "            <h3 style=\"margin-bottom: 0px;\">Scheduler</h3>\n",
       "            <p style=\"color: #9D9D9D; margin-bottom: 0px;\">Scheduler-b72aa615-4450-4731-80c9-2f687c769f7a</p>\n",
       "            <table style=\"width: 100%; text-align: left;\">\n",
       "                <tr>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Comm:</strong> tcp://127.0.0.1:44845\n",
       "                    </td>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Workers:</strong> 1\n",
       "                    </td>\n",
       "                </tr>\n",
       "                <tr>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Dashboard:</strong> <a href=\"http://127.0.0.1:8787/status\" target=\"_blank\">http://127.0.0.1:8787/status</a>\n",
       "                    </td>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Total threads:</strong> 4\n",
       "                    </td>\n",
       "                </tr>\n",
       "                <tr>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Started:</strong> Just now\n",
       "                    </td>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Total memory:</strong> 6.78 GiB\n",
       "                    </td>\n",
       "                </tr>\n",
       "            </table>\n",
       "        </div>\n",
       "    </div>\n",
       "\n",
       "    <details style=\"margin-left: 48px;\">\n",
       "        <summary style=\"margin-bottom: 20px;\">\n",
       "            <h3 style=\"display: inline;\">Workers</h3>\n",
       "        </summary>\n",
       "\n",
       "        \n",
       "        <div style=\"margin-bottom: 20px;\">\n",
       "            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n",
       "            <div style=\"margin-left: 48px;\">\n",
       "            <details>\n",
       "                <summary>\n",
       "                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 0</h4>\n",
       "                </summary>\n",
       "                <table style=\"width: 100%; text-align: left;\">\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Comm: </strong> tcp://127.0.0.1:33495\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Total threads: </strong> 4\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:33451/status\" target=\"_blank\">http://127.0.0.1:33451/status</a>\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Memory: </strong> 6.78 GiB\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Nanny: </strong> tcp://127.0.0.1:44275\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\"></td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td colspan=\"2\" style=\"text-align: left;\">\n",
       "                            <strong>Local directory: </strong> /home/runner/work/dask-examples/dask-examples/applications/dask-worker-space/worker-t7vty6j8\n",
       "                        </td>\n",
       "                    </tr>\n",
       "\n",
       "                    \n",
       "\n",
       "                    \n",
       "\n",
       "                </table>\n",
       "            </details>\n",
       "            </div>\n",
       "        </div>\n",
       "        \n",
       "\n",
       "    </details>\n",
       "</div>\n",
       "\n",
       "        </details>\n",
       "    </div>\n",
       "</div>\n",
       "            </details>\n",
       "        \n",
       "\n",
       "    </div>\n",
       "</div>"
      ],
      "text/plain": [
       "<Client: 'tcp://127.0.0.1:44845' processes=1 threads=4, memory=6.78 GiB>"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from dask.distributed import Client, progress\n",
    "client = Client(threads_per_worker=4, n_workers=1)\n",
    "client"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Define your computation calling function\n",
    "\n",
    "This function does a simple operation: add all numbers of a list/array together, but it also sleeps for a random amount of time to simulate real work. In real use cases, this could call another python module, or even run an executable using subprocess module."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:21.802242Z",
     "iopub.status.busy": "2022-06-16T17:44:21.801791Z",
     "iopub.status.idle": "2022-06-16T17:44:21.806705Z",
     "shell.execute_reply": "2022-06-16T17:44:21.805866Z"
    }
   },
   "outputs": [],
   "source": [
    "import time\n",
    "import random\n",
    "\n",
    "def costly_simulation(list_param):\n",
    "    time.sleep(random.random())\n",
    "    return sum(list_param)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We try it locally below"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:21.808682Z",
     "iopub.status.busy": "2022-06-16T17:44:21.808546Z",
     "iopub.status.idle": "2022-06-16T17:44:21.841550Z",
     "shell.execute_reply": "2022-06-16T17:44:21.840926Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 547 µs, sys: 0 ns, total: 547 µs\n",
      "Wall time: 26.4 ms\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "10"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%time costly_simulation([1, 2, 3, 4])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Define the set of input parameters to call the function\n",
    "\n",
    "We will generate a set of inputs on which we want to run our simulation function. Here we use Pandas dataframe, but we could also use a simple list. Lets say that our simulation is run with four parameters called param_[a-d]."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:21.843911Z",
     "iopub.status.busy": "2022-06-16T17:44:21.843546Z",
     "iopub.status.idle": "2022-06-16T17:44:21.855404Z",
     "shell.execute_reply": "2022-06-16T17:44:21.854970Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>param_a</th>\n",
       "      <th>param_b</th>\n",
       "      <th>param_c</th>\n",
       "      <th>param_d</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.667539</td>\n",
       "      <td>0.009313</td>\n",
       "      <td>0.225172</td>\n",
       "      <td>0.991435</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.343355</td>\n",
       "      <td>0.698226</td>\n",
       "      <td>0.819482</td>\n",
       "      <td>0.311573</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.604080</td>\n",
       "      <td>0.590820</td>\n",
       "      <td>0.407407</td>\n",
       "      <td>0.305409</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.845073</td>\n",
       "      <td>0.397241</td>\n",
       "      <td>0.723687</td>\n",
       "      <td>0.855452</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.979075</td>\n",
       "      <td>0.139649</td>\n",
       "      <td>0.326220</td>\n",
       "      <td>0.315027</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    param_a   param_b   param_c   param_d\n",
       "0  0.667539  0.009313  0.225172  0.991435\n",
       "1  0.343355  0.698226  0.819482  0.311573\n",
       "2  0.604080  0.590820  0.407407  0.305409\n",
       "3  0.845073  0.397241  0.723687  0.855452\n",
       "4  0.979075  0.139649  0.326220  0.315027"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "input_params = pd.DataFrame(np.random.random(size=(500, 4)),\n",
    "                            columns=['param_a', 'param_b', 'param_c', 'param_d'])\n",
    "input_params.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Without using Dask, we could call our simulation on all of these parameters using normal Python for loops.\n",
    "\n",
    "Let's only do this on a sample of our parameters as it would be quite long otherwise."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:21.857677Z",
     "iopub.status.busy": "2022-06-16T17:44:21.857412Z",
     "iopub.status.idle": "2022-06-16T17:44:21.860203Z",
     "shell.execute_reply": "2022-06-16T17:44:21.859667Z"
    }
   },
   "outputs": [],
   "source": [
    "results = []"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:21.863025Z",
     "iopub.status.busy": "2022-06-16T17:44:21.862636Z",
     "iopub.status.idle": "2022-06-16T17:44:26.438488Z",
     "shell.execute_reply": "2022-06-16T17:44:26.437250Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 125 ms, sys: 32.5 ms, total: 158 ms\n",
      "Wall time: 4.57 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "for parameters in input_params.values[:10]:\n",
    "    result = costly_simulation(parameters)\n",
    "    results.append(result)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:26.442997Z",
     "iopub.status.busy": "2022-06-16T17:44:26.442740Z",
     "iopub.status.idle": "2022-06-16T17:44:26.448572Z",
     "shell.execute_reply": "2022-06-16T17:44:26.447884Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[1.8934592437861366,\n",
       " 2.172635709644067,\n",
       " 1.9077164719100796,\n",
       " 2.8214525717564154,\n",
       " 1.7599703594349991,\n",
       " 1.067487525504247,\n",
       " 2.650991066519886,\n",
       " 1.5474113310638897,\n",
       " 2.6995449209539917,\n",
       " 2.0396545034862945]"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "results"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Note that this is not very clever as we can easily parallelize code. \n",
    "\n",
    "There are many ways to parallelize this function in Python with libraries like `multiprocessing`, `concurrent.futures`, `joblib` or others.  These are good first steps.  Dask is a good second step, especially when you want to scale across many machines.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Use [Dask Delayed](http://dask.pydata.org/en/latest/delayed.html) to make our function lazy\n",
    "\n",
    "We can call `dask.delayed` on our funtion to make it lazy.  Rather than compute its result immediately, it records what we want to compute as a task into a graph that we'll run later on parallel hardware. Using `dask.delayed` is a relatively straightforward way to parallelize an existing code base, even if the computation isn't embarrassingly parallel like this one. \n",
    "\n",
    "Calling these lazy functions is now almost free.  In the cell below we only construct a simple graph."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:26.451878Z",
     "iopub.status.busy": "2022-06-16T17:44:26.451128Z",
     "iopub.status.idle": "2022-06-16T17:44:26.454729Z",
     "shell.execute_reply": "2022-06-16T17:44:26.454217Z"
    }
   },
   "outputs": [],
   "source": [
    "import dask\n",
    "lazy_results = []"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:26.457605Z",
     "iopub.status.busy": "2022-06-16T17:44:26.456982Z",
     "iopub.status.idle": "2022-06-16T17:44:26.462384Z",
     "shell.execute_reply": "2022-06-16T17:44:26.461698Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 855 µs, sys: 0 ns, total: 855 µs\n",
      "Wall time: 861 µs\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "\n",
    "for parameters in input_params.values[:10]:\n",
    "    lazy_result = dask.delayed(costly_simulation)(parameters)\n",
    "    lazy_results.append(lazy_result)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:26.464825Z",
     "iopub.status.busy": "2022-06-16T17:44:26.464496Z",
     "iopub.status.idle": "2022-06-16T17:44:26.468594Z",
     "shell.execute_reply": "2022-06-16T17:44:26.468168Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Delayed('costly_simulation-4ba927a8-9b8d-422b-a71d-da73c9f1bae0')"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "lazy_results[0]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Run in parallel\n",
    "\n",
    "The `lazy_results` list contains information about ten calls to `costly_simulation` that have not yet been run.  Call `.compute()` when you want your result as normal Python objects.\n",
    "\n",
    "If you started `Client()` above then you may want to watch the status page during computation."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:26.471383Z",
     "iopub.status.busy": "2022-06-16T17:44:26.470986Z",
     "iopub.status.idle": "2022-06-16T17:44:28.133367Z",
     "shell.execute_reply": "2022-06-16T17:44:28.132902Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 208 ms, sys: 72.9 ms, total: 280 ms\n",
      "Wall time: 1.66 s\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "(1.8934592437861366,\n",
       " 2.172635709644067,\n",
       " 1.9077164719100796,\n",
       " 2.8214525717564154,\n",
       " 1.7599703594349991,\n",
       " 1.067487525504247,\n",
       " 2.650991066519886,\n",
       " 1.5474113310638897,\n",
       " 2.6995449209539917,\n",
       " 2.0396545034862945)"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%time dask.compute(*lazy_results)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Notice that this was faster than running these same computations sequentially with a for loop.  "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We can now run this on all of our input parameters:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:28.136405Z",
     "iopub.status.busy": "2022-06-16T17:44:28.136000Z",
     "iopub.status.idle": "2022-06-16T17:44:28.281271Z",
     "shell.execute_reply": "2022-06-16T17:44:28.252032Z"
    }
   },
   "outputs": [],
   "source": [
    "import dask\n",
    "lazy_results = []\n",
    "\n",
    "for parameters in input_params.values:\n",
    "    lazy_result = dask.delayed(costly_simulation)(parameters)\n",
    "    lazy_results.append(lazy_result)\n",
    "    \n",
    "futures = dask.persist(*lazy_results)  # trigger computation in the background"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "To make this go faster, we can add additional workers.\n",
    "\n",
    "(although we're still only working on our local machine, this is more practical when using an actual cluster)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:28.285272Z",
     "iopub.status.busy": "2022-06-16T17:44:28.285050Z",
     "iopub.status.idle": "2022-06-16T17:44:28.301366Z",
     "shell.execute_reply": "2022-06-16T17:44:28.300529Z"
    }
   },
   "outputs": [],
   "source": [
    "client.cluster.scale(10)  # ask for ten 4-thread workers"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "By looking at the Dask dashboard we can see that Dask spreads this work around our cluster, managing load balancing, dependencies, etc..\n",
    "\n",
    "Then get the result:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:28.305565Z",
     "iopub.status.busy": "2022-06-16T17:44:28.305202Z",
     "iopub.status.idle": "2022-06-16T17:44:39.610467Z",
     "shell.execute_reply": "2022-06-16T17:44:39.609630Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1.8934592437861366,\n",
       " 2.172635709644067,\n",
       " 1.9077164719100796,\n",
       " 2.8214525717564154,\n",
       " 1.7599703594349991)"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "results = dask.compute(*futures)\n",
    "results[:5]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Using the [Futures API](http://dask.pydata.org/en/latest/futures.html)\n",
    "\n",
    "The same example can be implemented using Dask's Futures API by using the `client` object itself.  For our use case of applying a function across many inputs both Dask delayed and Dask Futures are equally useful.  The Futures API is a little bit different because it starts work immediately rather than being completely lazy.\n",
    "\n",
    "For example, notice that work starts immediately in the cell below as we submit work to the cluster:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:39.614225Z",
     "iopub.status.busy": "2022-06-16T17:44:39.613694Z",
     "iopub.status.idle": "2022-06-16T17:44:41.336973Z",
     "shell.execute_reply": "2022-06-16T17:44:41.334713Z"
    }
   },
   "outputs": [],
   "source": [
    "futures = []\n",
    "for parameters in input_params.values:\n",
    "    future = client.submit(costly_simulation, parameters)\n",
    "    futures.append(future)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We can explicitly wait until this work is done and gather the results to our local process by calling `client.gather`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:41.362373Z",
     "iopub.status.busy": "2022-06-16T17:44:41.362151Z",
     "iopub.status.idle": "2022-06-16T17:44:47.884492Z",
     "shell.execute_reply": "2022-06-16T17:44:47.883865Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[1.8934592437861366,\n",
       " 2.172635709644067,\n",
       " 1.9077164719100796,\n",
       " 2.8214525717564154,\n",
       " 1.7599703594349991]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "results = client.gather(futures)\n",
    "results[:5]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "But the code above can be run in fewer lines with `client.map()` function, allowing to call a given function on a list of parameters.\n",
    "\n",
    "As for delayed, we can only start the computation and not wait for results by not calling `client.gather()` right now.\n",
    "\n",
    "It shall be noted that as Dask cluster has already performed tasks launching `costly_simulation` with Futures API on the given input parameters, the call to `client.map()` won't actually trigger any computation, and just retrieve already computed results."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:47.887016Z",
     "iopub.status.busy": "2022-06-16T17:44:47.886826Z",
     "iopub.status.idle": "2022-06-16T17:44:47.945039Z",
     "shell.execute_reply": "2022-06-16T17:44:47.944365Z"
    }
   },
   "outputs": [],
   "source": [
    "futures = client.map(costly_simulation, input_params.values)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Then just get the results later:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:47.949088Z",
     "iopub.status.busy": "2022-06-16T17:44:47.948593Z",
     "iopub.status.idle": "2022-06-16T17:44:48.002124Z",
     "shell.execute_reply": "2022-06-16T17:44:48.001057Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "500"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "results = client.gather(futures)\n",
    "len(results)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:48.005392Z",
     "iopub.status.busy": "2022-06-16T17:44:48.004838Z",
     "iopub.status.idle": "2022-06-16T17:44:48.011849Z",
     "shell.execute_reply": "2022-06-16T17:44:48.010393Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "1.8934592437861366\n"
     ]
    }
   ],
   "source": [
    "print(results[0])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We encourage you to watch the [dashboard's status page](http://127.0.0.1:8787) to watch on going computation."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Doing some analysis on the results\n",
    "\n",
    "One of the interests of Dask here, outside from API simplicity, is that you are able to gather the result for all your simulations in one call.  There is no need to implement a complex mechanism or to write individual results in a shared file system or object store.\n",
    "\n",
    "Just get your result, and do some computation."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Here, we will just get the results and expand our initial dataframe to have a nice view of parameters vs results for our computation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:48.014365Z",
     "iopub.status.busy": "2022-06-16T17:44:48.014083Z",
     "iopub.status.idle": "2022-06-16T17:44:48.027607Z",
     "shell.execute_reply": "2022-06-16T17:44:48.026824Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>param_a</th>\n",
       "      <th>param_b</th>\n",
       "      <th>param_c</th>\n",
       "      <th>param_d</th>\n",
       "      <th>result</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>139</th>\n",
       "      <td>0.532031</td>\n",
       "      <td>0.789187</td>\n",
       "      <td>0.192123</td>\n",
       "      <td>0.911385</td>\n",
       "      <td>2.424725</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>426</th>\n",
       "      <td>0.078395</td>\n",
       "      <td>0.295642</td>\n",
       "      <td>0.817000</td>\n",
       "      <td>0.983542</td>\n",
       "      <td>2.174579</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>369</th>\n",
       "      <td>0.517469</td>\n",
       "      <td>0.825415</td>\n",
       "      <td>0.082023</td>\n",
       "      <td>0.199941</td>\n",
       "      <td>1.624848</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>493</th>\n",
       "      <td>0.397718</td>\n",
       "      <td>0.510081</td>\n",
       "      <td>0.960874</td>\n",
       "      <td>0.598846</td>\n",
       "      <td>2.467520</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>51</th>\n",
       "      <td>0.148367</td>\n",
       "      <td>0.981928</td>\n",
       "      <td>0.963380</td>\n",
       "      <td>0.193547</td>\n",
       "      <td>2.287222</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      param_a   param_b   param_c   param_d    result\n",
       "139  0.532031  0.789187  0.192123  0.911385  2.424725\n",
       "426  0.078395  0.295642  0.817000  0.983542  2.174579\n",
       "369  0.517469  0.825415  0.082023  0.199941  1.624848\n",
       "493  0.397718  0.510081  0.960874  0.598846  2.467520\n",
       "51   0.148367  0.981928  0.963380  0.193547  2.287222"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "output = input_params.copy()\n",
    "output['result'] = pd.Series(results, index=output.index)\n",
    "output.sample(5)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Then we can do some nice statistical plots or save result locally with pandas interface here"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:48.030487Z",
     "iopub.status.busy": "2022-06-16T17:44:48.030027Z",
     "iopub.status.idle": "2022-06-16T17:44:48.857542Z",
     "shell.execute_reply": "2022-06-16T17:44:48.856972Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:>"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "%matplotlib inline\n",
    "output['result'].plot()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:48.860085Z",
     "iopub.status.busy": "2022-06-16T17:44:48.859942Z",
     "iopub.status.idle": "2022-06-16T17:44:48.865325Z",
     "shell.execute_reply": "2022-06-16T17:44:48.864918Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2.0020736482662818"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "output['result'].mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:48.867562Z",
     "iopub.status.busy": "2022-06-16T17:44:48.867304Z",
     "iopub.status.idle": "2022-06-16T17:44:48.875239Z",
     "shell.execute_reply": "2022-06-16T17:44:48.874476Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "251\n"
     ]
    }
   ],
   "source": [
    "filtered_output = output[output['result'] > 2]\n",
    "print(len(filtered_output))\n",
    "filtered_output.to_csv('/tmp/simulation_result.csv')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Handling very large simulation with [Bags](http://dask.pydata.org/en/latest/bag.html)\n",
    "\n",
    "The methods above work well for a size of input parameters up to about 100,000.  Above that, the Dask scheduler has trouble handling the amount of tasks to schedule to workers.  The solution to this problem is to bundle many parameters into a single task.\n",
    "You could do this either by making a new function that operated on a batch of parameters and using the delayed or futures APIs on that function.  You could also use the Dask Bag API.  This is described more in the documentation about [avoiding too many tasks](http://dask.pydata.org/en/latest/delayed-best-practices.html#avoid-too-many-tasks).\n",
    "\n",
    "Dask Bags hold onto large sequences in a few partitions.  We can convert our `input_params` sequence into a `dask.bag` collection, asking for fewer partitions (so at most 100,000, which is already huge), and apply our function on every item of the bag."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:48.878451Z",
     "iopub.status.busy": "2022-06-16T17:44:48.877946Z",
     "iopub.status.idle": "2022-06-16T17:44:48.890580Z",
     "shell.execute_reply": "2022-06-16T17:44:48.889840Z"
    }
   },
   "outputs": [],
   "source": [
    "import dask.bag as db\n",
    "b = db.from_sequence(list(input_params.values), npartitions=100)\n",
    "b = b.map(costly_simulation)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:48.895352Z",
     "iopub.status.busy": "2022-06-16T17:44:48.895025Z",
     "iopub.status.idle": "2022-06-16T17:44:57.825277Z",
     "shell.execute_reply": "2022-06-16T17:44:57.824149Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 904 ms, sys: 133 ms, total: 1.04 s\n",
      "Wall time: 8.92 s\n"
     ]
    }
   ],
   "source": [
    "%time results_bag = b.compute()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Looking on Dashboard here, you should see only 100 tasks to run instead of 500, each taking 5x more time in average, because each one is actually calling our function 5 times."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-16T17:44:57.828980Z",
     "iopub.status.busy": "2022-06-16T17:44:57.828094Z",
     "iopub.status.idle": "2022-06-16T17:44:57.841166Z",
     "shell.execute_reply": "2022-06-16T17:44:57.840656Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "np.all(results) == np.all(results_bag)"
   ]
  }
 ],
 "metadata": {
  "anaconda-cloud": {},
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
