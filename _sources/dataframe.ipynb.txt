{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Dask DataFrames\n",
    "\n",
    "<img src=\"images/dask-dataframe.svg\" \n",
    "     align=\"right\"\n",
    "     width=\"20%\"\n",
    "     alt=\"Dask dataframes are blocked Pandas dataframes\">\n",
    "     \n",
    "Dask Dataframes coordinate many Pandas dataframes, partitioned along an index.  They support a large subset of the Pandas API."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Start Dask Client for Dashboard\n",
    "\n",
    "Starting the Dask Client is optional.  It will provide a dashboard which \n",
    "is useful to gain insight on the computation.  \n",
    "\n",
    "The link to the dashboard will become visible when you create the client below.  We recommend having it open on one side of your screen while using your notebook on the other side.  This can take some effort to arrange your windows, but seeing them both at the same is very useful when learning."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:45.065507Z",
     "iopub.status.busy": "2022-05-11T21:15:45.065238Z",
     "iopub.status.idle": "2022-05-11T21:15:46.896786Z",
     "shell.execute_reply": "2022-05-11T21:15:46.896215Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "    <div style=\"width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;\"> </div>\n",
       "    <div style=\"margin-left: 48px;\">\n",
       "        <h3 style=\"margin-bottom: 0px;\">Client</h3>\n",
       "        <p style=\"color: #9D9D9D; margin-bottom: 0px;\">Client-85929d27-d16f-11ec-9923-000d3a9cbfb9</p>\n",
       "        <table style=\"width: 100%; text-align: left;\">\n",
       "\n",
       "        <tr>\n",
       "        \n",
       "            <td style=\"text-align: left;\"><strong>Connection method:</strong> Cluster object</td>\n",
       "            <td style=\"text-align: left;\"><strong>Cluster type:</strong> distributed.LocalCluster</td>\n",
       "        \n",
       "        </tr>\n",
       "\n",
       "        \n",
       "            <tr>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:8787/status\" target=\"_blank\">http://127.0.0.1:8787/status</a>\n",
       "                </td>\n",
       "                <td style=\"text-align: left;\"></td>\n",
       "            </tr>\n",
       "        \n",
       "\n",
       "        </table>\n",
       "\n",
       "        \n",
       "            <details>\n",
       "            <summary style=\"margin-bottom: 20px;\"><h3 style=\"display: inline;\">Cluster Info</h3></summary>\n",
       "            <div class=\"jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output\">\n",
       "    <div style=\"width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;\">\n",
       "    </div>\n",
       "    <div style=\"margin-left: 48px;\">\n",
       "        <h3 style=\"margin-bottom: 0px; margin-top: 0px;\">LocalCluster</h3>\n",
       "        <p style=\"color: #9D9D9D; margin-bottom: 0px;\">74c33a13</p>\n",
       "        <table style=\"width: 100%; text-align: left;\">\n",
       "            <tr>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Dashboard:</strong> <a href=\"http://127.0.0.1:8787/status\" target=\"_blank\">http://127.0.0.1:8787/status</a>\n",
       "                </td>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Workers:</strong> 2\n",
       "                </td>\n",
       "            </tr>\n",
       "            <tr>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Total threads:</strong> 4\n",
       "                </td>\n",
       "                <td style=\"text-align: left;\">\n",
       "                    <strong>Total memory:</strong> 1.86 GiB\n",
       "                </td>\n",
       "            </tr>\n",
       "            \n",
       "            <tr>\n",
       "    <td style=\"text-align: left;\"><strong>Status:</strong> running</td>\n",
       "    <td style=\"text-align: left;\"><strong>Using processes:</strong> True</td>\n",
       "</tr>\n",
       "\n",
       "            \n",
       "        </table>\n",
       "\n",
       "        <details>\n",
       "            <summary style=\"margin-bottom: 20px;\">\n",
       "                <h3 style=\"display: inline;\">Scheduler Info</h3>\n",
       "            </summary>\n",
       "\n",
       "            <div style=\"\">\n",
       "    <div>\n",
       "        <div style=\"width: 24px; height: 24px; background-color: #FFF7E5; border: 3px solid #FF6132; border-radius: 5px; position: absolute;\"> </div>\n",
       "        <div style=\"margin-left: 48px;\">\n",
       "            <h3 style=\"margin-bottom: 0px;\">Scheduler</h3>\n",
       "            <p style=\"color: #9D9D9D; margin-bottom: 0px;\">Scheduler-bfdd45a1-bdf6-4dfd-a93e-8e0e5436c042</p>\n",
       "            <table style=\"width: 100%; text-align: left;\">\n",
       "                <tr>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Comm:</strong> tcp://127.0.0.1:36187\n",
       "                    </td>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Workers:</strong> 2\n",
       "                    </td>\n",
       "                </tr>\n",
       "                <tr>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Dashboard:</strong> <a href=\"http://127.0.0.1:8787/status\" target=\"_blank\">http://127.0.0.1:8787/status</a>\n",
       "                    </td>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Total threads:</strong> 4\n",
       "                    </td>\n",
       "                </tr>\n",
       "                <tr>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Started:</strong> Just now\n",
       "                    </td>\n",
       "                    <td style=\"text-align: left;\">\n",
       "                        <strong>Total memory:</strong> 1.86 GiB\n",
       "                    </td>\n",
       "                </tr>\n",
       "            </table>\n",
       "        </div>\n",
       "    </div>\n",
       "\n",
       "    <details style=\"margin-left: 48px;\">\n",
       "        <summary style=\"margin-bottom: 20px;\">\n",
       "            <h3 style=\"display: inline;\">Workers</h3>\n",
       "        </summary>\n",
       "\n",
       "        \n",
       "        <div style=\"margin-bottom: 20px;\">\n",
       "            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n",
       "            <div style=\"margin-left: 48px;\">\n",
       "            <details>\n",
       "                <summary>\n",
       "                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 0</h4>\n",
       "                </summary>\n",
       "                <table style=\"width: 100%; text-align: left;\">\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Comm: </strong> tcp://127.0.0.1:35859\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Total threads: </strong> 2\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:46845/status\" target=\"_blank\">http://127.0.0.1:46845/status</a>\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Memory: </strong> 0.93 GiB\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Nanny: </strong> tcp://127.0.0.1:42887\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\"></td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td colspan=\"2\" style=\"text-align: left;\">\n",
       "                            <strong>Local directory: </strong> /home/runner/work/dask-examples/dask-examples/dask-worker-space/worker-8sg4xd97\n",
       "                        </td>\n",
       "                    </tr>\n",
       "\n",
       "                    \n",
       "\n",
       "                    \n",
       "\n",
       "                </table>\n",
       "            </details>\n",
       "            </div>\n",
       "        </div>\n",
       "        \n",
       "        <div style=\"margin-bottom: 20px;\">\n",
       "            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n",
       "            <div style=\"margin-left: 48px;\">\n",
       "            <details>\n",
       "                <summary>\n",
       "                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 1</h4>\n",
       "                </summary>\n",
       "                <table style=\"width: 100%; text-align: left;\">\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Comm: </strong> tcp://127.0.0.1:35193\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Total threads: </strong> 2\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:37951/status\" target=\"_blank\">http://127.0.0.1:37951/status</a>\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Memory: </strong> 0.93 GiB\n",
       "                        </td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td style=\"text-align: left;\">\n",
       "                            <strong>Nanny: </strong> tcp://127.0.0.1:44751\n",
       "                        </td>\n",
       "                        <td style=\"text-align: left;\"></td>\n",
       "                    </tr>\n",
       "                    <tr>\n",
       "                        <td colspan=\"2\" style=\"text-align: left;\">\n",
       "                            <strong>Local directory: </strong> /home/runner/work/dask-examples/dask-examples/dask-worker-space/worker-evsylk6v\n",
       "                        </td>\n",
       "                    </tr>\n",
       "\n",
       "                    \n",
       "\n",
       "                    \n",
       "\n",
       "                </table>\n",
       "            </details>\n",
       "            </div>\n",
       "        </div>\n",
       "        \n",
       "\n",
       "    </details>\n",
       "</div>\n",
       "\n",
       "        </details>\n",
       "    </div>\n",
       "</div>\n",
       "            </details>\n",
       "        \n",
       "\n",
       "    </div>\n",
       "</div>"
      ],
      "text/plain": [
       "<Client: 'tcp://127.0.0.1:36187' processes=2 threads=4, memory=1.86 GiB>"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from dask.distributed import Client\n",
    "\n",
    "client = Client(n_workers=2, threads_per_worker=2, memory_limit=\"1GB\")\n",
    "client\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Create Random Dataframe\n",
    "\n",
    "We create a random timeseries of data with the following attributes:\n",
    "\n",
    "1.  It stores a record for every second in the month of January of the year 2000\n",
    "2.  It splits that month by day, keeping each day as a partitioned dataframe\n",
    "3.  Along with a datetime index it has columns for names, ids, and numeric values\n",
    "\n",
    "This is a small dataset of about 240 MB. Increase the number of days or reduce the time interval between data points to practice with a larger dataset by setting some of the [`dask.datasets.timeseries()` arguments](https://docs.dask.org/en/stable/api.html#dask.datasets.timeseries)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:46.899848Z",
     "iopub.status.busy": "2022-05-11T21:15:46.899658Z",
     "iopub.status.idle": "2022-05-11T21:15:47.191478Z",
     "shell.execute_reply": "2022-05-11T21:15:47.190922Z"
    }
   },
   "outputs": [],
   "source": [
    "import dask\n",
    "\n",
    "df = dask.datasets.timeseries()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Unlike Pandas, Dask DataFrames are _lazy_, meaning that data is only loaded when it is needed for a computation. No data is printed here, instead it is replaced by ellipses (`...`)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:47.194792Z",
     "iopub.status.busy": "2022-05-11T21:15:47.194495Z",
     "iopub.status.idle": "2022-05-11T21:15:47.210152Z",
     "shell.execute_reply": "2022-05-11T21:15:47.209691Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><strong>Dask DataFrame Structure:</strong></div>\n",
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>name</th>\n",
       "      <th>x</th>\n",
       "      <th>y</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>npartitions=30</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2000-01-01</th>\n",
       "      <td>int64</td>\n",
       "      <td>object</td>\n",
       "      <td>float64</td>\n",
       "      <td>float64</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-02</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-30</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-31</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>\n",
       "<div>Dask Name: make-timeseries, 30 tasks</div>"
      ],
      "text/plain": [
       "Dask DataFrame Structure:\n",
       "                   id    name        x        y\n",
       "npartitions=30                                 \n",
       "2000-01-01      int64  object  float64  float64\n",
       "2000-01-02        ...     ...      ...      ...\n",
       "...               ...     ...      ...      ...\n",
       "2000-01-30        ...     ...      ...      ...\n",
       "2000-01-31        ...     ...      ...      ...\n",
       "Dask Name: make-timeseries, 30 tasks"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Nonetheless, the column names and dtypes are known."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:47.213084Z",
     "iopub.status.busy": "2022-05-11T21:15:47.212574Z",
     "iopub.status.idle": "2022-05-11T21:15:47.218902Z",
     "shell.execute_reply": "2022-05-11T21:15:47.218448Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "id        int64\n",
       "name     object\n",
       "x       float64\n",
       "y       float64\n",
       "dtype: object"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.dtypes\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Some operations will automatically display the data."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:47.221196Z",
     "iopub.status.busy": "2022-05-11T21:15:47.220921Z",
     "iopub.status.idle": "2022-05-11T21:15:47.224008Z",
     "shell.execute_reply": "2022-05-11T21:15:47.223497Z"
    }
   },
   "outputs": [],
   "source": [
    "# This sets some formatting parameters for displayed data.\n",
    "import pandas as pd\n",
    "\n",
    "pd.options.display.precision = 2\n",
    "pd.options.display.max_rows = 10\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:47.226230Z",
     "iopub.status.busy": "2022-05-11T21:15:47.226070Z",
     "iopub.status.idle": "2022-05-11T21:15:47.625852Z",
     "shell.execute_reply": "2022-05-11T21:15:47.625348Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>name</th>\n",
       "      <th>x</th>\n",
       "      <th>y</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>timestamp</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2000-01-01 00:00:00</th>\n",
       "      <td>993</td>\n",
       "      <td>Wendy</td>\n",
       "      <td>0.16</td>\n",
       "      <td>-0.77</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-01 00:00:01</th>\n",
       "      <td>1026</td>\n",
       "      <td>Oliver</td>\n",
       "      <td>0.53</td>\n",
       "      <td>0.10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-01 00:00:02</th>\n",
       "      <td>1014</td>\n",
       "      <td>Hannah</td>\n",
       "      <td>0.82</td>\n",
       "      <td>0.02</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                       id    name     x     y\n",
       "timestamp                                    \n",
       "2000-01-01 00:00:00   993   Wendy  0.16 -0.77\n",
       "2000-01-01 00:00:01  1026  Oliver  0.53  0.10\n",
       "2000-01-01 00:00:02  1014  Hannah  0.82  0.02"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head(3)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Use Standard Pandas Operations\n",
    "\n",
    "Most common Pandas operations can be used in the same way on Dask dataframes. This example shows how to slice the data based on a mask condition and then determine the standard deviation of the data in the `x` column."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:47.628484Z",
     "iopub.status.busy": "2022-05-11T21:15:47.628101Z",
     "iopub.status.idle": "2022-05-11T21:15:47.653074Z",
     "shell.execute_reply": "2022-05-11T21:15:47.652466Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Dask Series Structure:\n",
       "npartitions=1\n",
       "    float64\n",
       "        ...\n",
       "Name: x, dtype: float64\n",
       "Dask Name: sqrt, 157 tasks"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df2 = df[df.y > 0]\n",
    "df3 = df2.groupby(\"name\").x.std()\n",
    "df3\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Notice that the data in `df3` are still represented by ellipses. All of the operations in the previous cell are lazy operations. You can call `.compute()` when you want your result as a Pandas dataframe or series.\n",
    "\n",
    "If you started `Client()` above then you can watch the status page during computation to see the progress."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:47.655698Z",
     "iopub.status.busy": "2022-05-11T21:15:47.655388Z",
     "iopub.status.idle": "2022-05-11T21:15:48.562426Z",
     "shell.execute_reply": "2022-05-11T21:15:48.561904Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "pandas.core.series.Series"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "computed_df = df3.compute()\n",
    "type(computed_df)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:48.565010Z",
     "iopub.status.busy": "2022-05-11T21:15:48.564829Z",
     "iopub.status.idle": "2022-05-11T21:15:48.572303Z",
     "shell.execute_reply": "2022-05-11T21:15:48.571838Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "name\n",
       "Alice      0.58\n",
       "Bob        0.58\n",
       "Charlie    0.58\n",
       "Dan        0.58\n",
       "Edith      0.58\n",
       "           ... \n",
       "Victor     0.58\n",
       "Wendy      0.58\n",
       "Xavier     0.58\n",
       "Yvonne     0.58\n",
       "Zelda      0.58\n",
       "Name: x, Length: 26, dtype: float64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "computed_df\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Notice that the computed data are now shown in the output.\n",
    "\n",
    "Another example calculation is to aggregate multiple columns, as shown below. Once again, the dashboard will show the progress of the computation."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:48.574994Z",
     "iopub.status.busy": "2022-05-11T21:15:48.574827Z",
     "iopub.status.idle": "2022-05-11T21:15:49.164769Z",
     "shell.execute_reply": "2022-05-11T21:15:49.164351Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>x</th>\n",
       "      <th>y</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>name</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Alice</th>\n",
       "      <td>347.34</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bob</th>\n",
       "      <td>120.95</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Charlie</th>\n",
       "      <td>208.01</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Dan</th>\n",
       "      <td>-137.61</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Edith</th>\n",
       "      <td>-171.23</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Victor</th>\n",
       "      <td>56.58</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Wendy</th>\n",
       "      <td>184.08</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Xavier</th>\n",
       "      <td>208.06</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Yvonne</th>\n",
       "      <td>-119.79</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Zelda</th>\n",
       "      <td>216.16</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>26 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              x    y\n",
       "name                \n",
       "Alice    347.34  1.0\n",
       "Bob      120.95  1.0\n",
       "Charlie  208.01  1.0\n",
       "Dan     -137.61  1.0\n",
       "Edith   -171.23  1.0\n",
       "...         ...  ...\n",
       "Victor    56.58  1.0\n",
       "Wendy    184.08  1.0\n",
       "Xavier   208.06  1.0\n",
       "Yvonne  -119.79  1.0\n",
       "Zelda    216.16  1.0\n",
       "\n",
       "[26 rows x 2 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df4 = df.groupby(\"name\").aggregate({\"x\": \"sum\", \"y\": \"max\"})\n",
    "df4.compute()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Dask dataframes can also be joined like Pandas dataframes. In this example we join the aggregated data in `df4` with the original data in `df`. Since the index in `df` is the timeseries and `df4` is indexed by names, we use `left_on=\"name\"` and `right_index=True` to define the merge columns. We also set suffixes for any columns that are common between the two dataframes so that we can distinguish them.\n",
    "\n",
    "Finally, since `df4` is small, we also make sure that it is a single partition dataframe."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:49.167333Z",
     "iopub.status.busy": "2022-05-11T21:15:49.166905Z",
     "iopub.status.idle": "2022-05-11T21:15:49.838020Z",
     "shell.execute_reply": "2022-05-11T21:15:49.837530Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>name</th>\n",
       "      <th>x_original</th>\n",
       "      <th>y_original</th>\n",
       "      <th>x_aggregated</th>\n",
       "      <th>y_aggregated</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>timestamp</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2000-01-01 00:00:00</th>\n",
       "      <td>993</td>\n",
       "      <td>Wendy</td>\n",
       "      <td>0.16</td>\n",
       "      <td>-7.69e-01</td>\n",
       "      <td>184.08</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-01 00:00:05</th>\n",
       "      <td>1033</td>\n",
       "      <td>Wendy</td>\n",
       "      <td>0.20</td>\n",
       "      <td>-6.48e-03</td>\n",
       "      <td>184.08</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-01 00:00:07</th>\n",
       "      <td>1015</td>\n",
       "      <td>Wendy</td>\n",
       "      <td>-0.85</td>\n",
       "      <td>-1.96e-01</td>\n",
       "      <td>184.08</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-01 00:00:45</th>\n",
       "      <td>1014</td>\n",
       "      <td>Wendy</td>\n",
       "      <td>-0.09</td>\n",
       "      <td>1.69e-03</td>\n",
       "      <td>184.08</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-01 00:01:10</th>\n",
       "      <td>986</td>\n",
       "      <td>Wendy</td>\n",
       "      <td>-0.21</td>\n",
       "      <td>4.00e-01</td>\n",
       "      <td>184.08</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                       id   name  x_original  y_original  x_aggregated  \\\n",
       "timestamp                                                                \n",
       "2000-01-01 00:00:00   993  Wendy        0.16   -7.69e-01        184.08   \n",
       "2000-01-01 00:00:05  1033  Wendy        0.20   -6.48e-03        184.08   \n",
       "2000-01-01 00:00:07  1015  Wendy       -0.85   -1.96e-01        184.08   \n",
       "2000-01-01 00:00:45  1014  Wendy       -0.09    1.69e-03        184.08   \n",
       "2000-01-01 00:01:10   986  Wendy       -0.21    4.00e-01        184.08   \n",
       "\n",
       "                     y_aggregated  \n",
       "timestamp                          \n",
       "2000-01-01 00:00:00           1.0  \n",
       "2000-01-01 00:00:05           1.0  \n",
       "2000-01-01 00:00:07           1.0  \n",
       "2000-01-01 00:00:45           1.0  \n",
       "2000-01-01 00:01:10           1.0  "
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df4 = df4.repartition(npartitions=1)\n",
    "joined = df.merge(\n",
    "    df4, left_on=\"name\", right_index=True, suffixes=(\"_original\", \"_aggregated\")\n",
    ")\n",
    "joined.head()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Persist data in memory\n",
    "\n",
    "If you have the available RAM for your dataset then you can persist data in memory.  \n",
    "\n",
    "This allows future computations to be much faster."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:49.842491Z",
     "iopub.status.busy": "2022-05-11T21:15:49.841315Z",
     "iopub.status.idle": "2022-05-11T21:15:49.857016Z",
     "shell.execute_reply": "2022-05-11T21:15:49.856455Z"
    }
   },
   "outputs": [],
   "source": [
    "df = df.persist()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Time Series Operations\n",
    "\n",
    "Because `df` has a datetime index, time-series operations work efficiently.\n",
    "\n",
    "The first example below resamples the data at 1 hour intervals to reduce the total size of the dataframe. Then the mean of the `x` and `y` columns are taken."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:49.862043Z",
     "iopub.status.busy": "2022-05-11T21:15:49.861838Z",
     "iopub.status.idle": "2022-05-11T21:15:50.090882Z",
     "shell.execute_reply": "2022-05-11T21:15:50.090253Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>x</th>\n",
       "      <th>y</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>timestamp</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2000-01-01 00:00:00</th>\n",
       "      <td>-5.75e-03</td>\n",
       "      <td>6.05e-03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-01 01:00:00</th>\n",
       "      <td>-7.13e-03</td>\n",
       "      <td>-2.22e-03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-01 02:00:00</th>\n",
       "      <td>1.74e-02</td>\n",
       "      <td>-2.12e-02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-01 03:00:00</th>\n",
       "      <td>1.20e-02</td>\n",
       "      <td>5.98e-03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-01 04:00:00</th>\n",
       "      <td>3.40e-04</td>\n",
       "      <td>8.43e-03</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                            x         y\n",
       "timestamp                              \n",
       "2000-01-01 00:00:00 -5.75e-03  6.05e-03\n",
       "2000-01-01 01:00:00 -7.13e-03 -2.22e-03\n",
       "2000-01-01 02:00:00  1.74e-02 -2.12e-02\n",
       "2000-01-01 03:00:00  1.20e-02  5.98e-03\n",
       "2000-01-01 04:00:00  3.40e-04  8.43e-03"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df[[\"x\", \"y\"]].resample(\"1h\").mean().head()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The next example resamples the data at 24 hour intervals and plots the mean values. Notice that `plot()` is called after `compute()` because `plot()` will not work until the data are computed."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:50.094096Z",
     "iopub.status.busy": "2022-05-11T21:15:50.093911Z",
     "iopub.status.idle": "2022-05-11T21:15:51.770525Z",
     "shell.execute_reply": "2022-05-11T21:15:51.769969Z"
    }
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "%matplotlib inline\n",
    "df[['x', 'y']].resample('24h').mean().compute().plot();"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This final example computes the rolling 24 hour mean of the data."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:51.773115Z",
     "iopub.status.busy": "2022-05-11T21:15:51.772865Z",
     "iopub.status.idle": "2022-05-11T21:15:51.814754Z",
     "shell.execute_reply": "2022-05-11T21:15:51.814373Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>x</th>\n",
       "      <th>y</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>timestamp</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2000-01-01 00:00:00</th>\n",
       "      <td>0.16</td>\n",
       "      <td>-0.77</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-01 00:00:01</th>\n",
       "      <td>0.35</td>\n",
       "      <td>-0.34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-01 00:00:02</th>\n",
       "      <td>0.50</td>\n",
       "      <td>-0.22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-01 00:00:03</th>\n",
       "      <td>0.19</td>\n",
       "      <td>-0.26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-01 00:00:04</th>\n",
       "      <td>0.27</td>\n",
       "      <td>-0.35</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        x     y\n",
       "timestamp                      \n",
       "2000-01-01 00:00:00  0.16 -0.77\n",
       "2000-01-01 00:00:01  0.35 -0.34\n",
       "2000-01-01 00:00:02  0.50 -0.22\n",
       "2000-01-01 00:00:03  0.19 -0.26\n",
       "2000-01-01 00:00:04  0.27 -0.35"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df[[\"x\", \"y\"]].rolling(window=\"24h\").mean().head()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Random access is cheap along the index, but must since the Dask dataframe is lazy, it must be computed to materialize the data."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:51.820033Z",
     "iopub.status.busy": "2022-05-11T21:15:51.819123Z",
     "iopub.status.idle": "2022-05-11T21:15:51.837429Z",
     "shell.execute_reply": "2022-05-11T21:15:51.836927Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><strong>Dask DataFrame Structure:</strong></div>\n",
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>name</th>\n",
       "      <th>x</th>\n",
       "      <th>y</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>npartitions=1</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2000-01-05 00:00:00.000000000</th>\n",
       "      <td>int64</td>\n",
       "      <td>object</td>\n",
       "      <td>float64</td>\n",
       "      <td>float64</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-05 23:59:59.999999999</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>\n",
       "<div>Dask Name: loc, 31 tasks</div>"
      ],
      "text/plain": [
       "Dask DataFrame Structure:\n",
       "                                  id    name        x        y\n",
       "npartitions=1                                                 \n",
       "2000-01-05 00:00:00.000000000  int64  object  float64  float64\n",
       "2000-01-05 23:59:59.999999999    ...     ...      ...      ...\n",
       "Dask Name: loc, 31 tasks"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.loc[\"2000-01-05\"]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:51.840327Z",
     "iopub.status.busy": "2022-05-11T21:15:51.840020Z",
     "iopub.status.idle": "2022-05-11T21:15:51.915677Z",
     "shell.execute_reply": "2022-05-11T21:15:51.915164Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 36.2 ms, sys: 502 µs, total: 36.7 ms\n",
      "Wall time: 60.7 ms\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>name</th>\n",
       "      <th>x</th>\n",
       "      <th>y</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>timestamp</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2000-01-05 00:00:00</th>\n",
       "      <td>1034</td>\n",
       "      <td>Charlie</td>\n",
       "      <td>0.74</td>\n",
       "      <td>-0.65</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-05 00:00:01</th>\n",
       "      <td>1027</td>\n",
       "      <td>Ray</td>\n",
       "      <td>-0.22</td>\n",
       "      <td>-0.09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-05 00:00:02</th>\n",
       "      <td>1018</td>\n",
       "      <td>George</td>\n",
       "      <td>0.18</td>\n",
       "      <td>0.01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-05 00:00:03</th>\n",
       "      <td>984</td>\n",
       "      <td>Dan</td>\n",
       "      <td>-0.96</td>\n",
       "      <td>0.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-05 00:00:04</th>\n",
       "      <td>1023</td>\n",
       "      <td>Quinn</td>\n",
       "      <td>-0.66</td>\n",
       "      <td>0.21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-05 23:59:55</th>\n",
       "      <td>1026</td>\n",
       "      <td>Yvonne</td>\n",
       "      <td>0.81</td>\n",
       "      <td>-0.04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-05 23:59:56</th>\n",
       "      <td>948</td>\n",
       "      <td>Hannah</td>\n",
       "      <td>0.42</td>\n",
       "      <td>-0.33</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-05 23:59:57</th>\n",
       "      <td>988</td>\n",
       "      <td>Ray</td>\n",
       "      <td>0.10</td>\n",
       "      <td>0.25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-05 23:59:58</th>\n",
       "      <td>967</td>\n",
       "      <td>Ursula</td>\n",
       "      <td>0.62</td>\n",
       "      <td>0.88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2000-01-05 23:59:59</th>\n",
       "      <td>997</td>\n",
       "      <td>Wendy</td>\n",
       "      <td>-0.75</td>\n",
       "      <td>-0.92</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>86400 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                       id     name     x     y\n",
       "timestamp                                     \n",
       "2000-01-05 00:00:00  1034  Charlie  0.74 -0.65\n",
       "2000-01-05 00:00:01  1027      Ray -0.22 -0.09\n",
       "2000-01-05 00:00:02  1018   George  0.18  0.01\n",
       "2000-01-05 00:00:03   984      Dan -0.96  0.07\n",
       "2000-01-05 00:00:04  1023    Quinn -0.66  0.21\n",
       "...                   ...      ...   ...   ...\n",
       "2000-01-05 23:59:55  1026   Yvonne  0.81 -0.04\n",
       "2000-01-05 23:59:56   948   Hannah  0.42 -0.33\n",
       "2000-01-05 23:59:57   988      Ray  0.10  0.25\n",
       "2000-01-05 23:59:58   967   Ursula  0.62  0.88\n",
       "2000-01-05 23:59:59   997    Wendy -0.75 -0.92\n",
       "\n",
       "[86400 rows x 4 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%time df.loc['2000-01-05'].compute()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Set Index\n",
    "\n",
    "Data is sorted by the index column. This allows for faster access, joins, groupby-apply operations, and more. However sorting data can be costly to do in parallel, so setting the index is both important to do, but only infrequently. In the next few examples, we will group the data by the `name` column, so we will set that column as the index to improve efficiency."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:51.918809Z",
     "iopub.status.busy": "2022-05-11T21:15:51.918229Z",
     "iopub.status.idle": "2022-05-11T21:15:53.397638Z",
     "shell.execute_reply": "2022-05-11T21:15:53.396871Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><strong>Dask DataFrame Structure:</strong></div>\n",
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>x</th>\n",
       "      <th>y</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>npartitions=26</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Alice</th>\n",
       "      <td>int64</td>\n",
       "      <td>float64</td>\n",
       "      <td>float64</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bob</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Zelda</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Zelda</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>\n",
       "<div>Dask Name: sort_index, 954 tasks</div>"
      ],
      "text/plain": [
       "Dask DataFrame Structure:\n",
       "                   id        x        y\n",
       "npartitions=26                         \n",
       "Alice           int64  float64  float64\n",
       "Bob               ...      ...      ...\n",
       "...               ...      ...      ...\n",
       "Zelda             ...      ...      ...\n",
       "Zelda             ...      ...      ...\n",
       "Dask Name: sort_index, 954 tasks"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df5 = df.set_index(\"name\")\n",
    "df5\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Because resetting the index for this dataset is expensive and we can fit it in our available RAM, we persist the dataset to memory."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:53.400429Z",
     "iopub.status.busy": "2022-05-11T21:15:53.400135Z",
     "iopub.status.idle": "2022-05-11T21:15:53.460581Z",
     "shell.execute_reply": "2022-05-11T21:15:53.459395Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><strong>Dask DataFrame Structure:</strong></div>\n",
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>x</th>\n",
       "      <th>y</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>npartitions=26</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Alice</th>\n",
       "      <td>int64</td>\n",
       "      <td>float64</td>\n",
       "      <td>float64</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bob</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Zelda</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Zelda</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>\n",
       "<div>Dask Name: sort_index, 26 tasks</div>"
      ],
      "text/plain": [
       "Dask DataFrame Structure:\n",
       "                   id        x        y\n",
       "npartitions=26                         \n",
       "Alice           int64  float64  float64\n",
       "Bob               ...      ...      ...\n",
       "...               ...      ...      ...\n",
       "Zelda             ...      ...      ...\n",
       "Zelda             ...      ...      ...\n",
       "Dask Name: sort_index, 26 tasks"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df5 = df5.persist()\n",
    "df5\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Dask now knows where all data lives, indexed by name. As a result operations like random access are cheap and efficient."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:53.464511Z",
     "iopub.status.busy": "2022-05-11T21:15:53.464121Z",
     "iopub.status.idle": "2022-05-11T21:15:55.281620Z",
     "shell.execute_reply": "2022-05-11T21:15:55.281180Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 314 ms, sys: 30.3 ms, total: 344 ms\n",
      "Wall time: 1.8 s\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>x</th>\n",
       "      <th>y</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>name</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Alice</th>\n",
       "      <td>979</td>\n",
       "      <td>-0.44</td>\n",
       "      <td>-0.83</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Alice</th>\n",
       "      <td>1009</td>\n",
       "      <td>0.45</td>\n",
       "      <td>-0.92</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Alice</th>\n",
       "      <td>1008</td>\n",
       "      <td>0.42</td>\n",
       "      <td>-0.02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Alice</th>\n",
       "      <td>978</td>\n",
       "      <td>-0.30</td>\n",
       "      <td>0.75</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Alice</th>\n",
       "      <td>1028</td>\n",
       "      <td>0.96</td>\n",
       "      <td>0.73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Alice</th>\n",
       "      <td>1029</td>\n",
       "      <td>-0.27</td>\n",
       "      <td>0.21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Alice</th>\n",
       "      <td>1019</td>\n",
       "      <td>0.52</td>\n",
       "      <td>0.51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Alice</th>\n",
       "      <td>995</td>\n",
       "      <td>-0.46</td>\n",
       "      <td>0.77</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Alice</th>\n",
       "      <td>987</td>\n",
       "      <td>0.14</td>\n",
       "      <td>-0.93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Alice</th>\n",
       "      <td>965</td>\n",
       "      <td>-0.18</td>\n",
       "      <td>0.83</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100100 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         id     x     y\n",
       "name                   \n",
       "Alice   979 -0.44 -0.83\n",
       "Alice  1009  0.45 -0.92\n",
       "Alice  1008  0.42 -0.02\n",
       "Alice   978 -0.30  0.75\n",
       "Alice  1028  0.96  0.73\n",
       "...     ...   ...   ...\n",
       "Alice  1029 -0.27  0.21\n",
       "Alice  1019  0.52  0.51\n",
       "Alice   995 -0.46  0.77\n",
       "Alice   987  0.14 -0.93\n",
       "Alice   965 -0.18  0.83\n",
       "\n",
       "[100100 rows x 3 columns]"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%time df5.loc['Alice'].compute()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Groupby Apply with Scikit-Learn"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now that our data is sorted by name we can inexpensively do operations like random access on name, or groupby-apply with custom functions.\n",
    "\n",
    "Here we train a different scikit-learn linear regression model on each name."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:55.286293Z",
     "iopub.status.busy": "2022-05-11T21:15:55.286004Z",
     "iopub.status.idle": "2022-05-11T21:15:55.981692Z",
     "shell.execute_reply": "2022-05-11T21:15:55.981194Z"
    }
   },
   "outputs": [],
   "source": [
    "from sklearn.linear_model import LinearRegression\n",
    "\n",
    "\n",
    "def train(partition):\n",
    "    if not len(partition):\n",
    "        return\n",
    "    est = LinearRegression()\n",
    "    est.fit(partition[[\"x\"]].values, partition.y.values)\n",
    "    return est\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The `partition` argument to `train()` will be one of the group instances from the `DataFrameGroupBy`. If there is no data in the partition, we don't need to proceed. If there is data, we want to fit the linear regression model and return that as the value for this group.\n",
    "\n",
    "Now working with `df5`, whose index is the names from `df`, we can group by the `names` column. This also happens to be the index, but that's fine. Then we use `.apply()` to run `train()` on each group in the `DataFrameGroupBy` generated by `.groupby()`.\n",
    "\n",
    "The `meta` argument tells Dask how to create the `DataFrame` or `Series` that will hold the result of `.apply()`. In this case, `train()` returns a single value, so `.apply()` will create a `Series`. This means we need to tell Dask what the type of that single column should be and optionally give it a name.\n",
    "\n",
    "The easiest way to specify a single column is with a tuple. The name of the column is the first element of the tuple. Since this is a series of linear regressions, we will name the column `\"LinearRegression\"`. The second element of the tuple is the type of the return value of `train`. In this case, Pandas will store the result as a general `object`, which should be the type we pass."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-05-11T21:15:55.987030Z",
     "iopub.status.busy": "2022-05-11T21:15:55.986850Z",
     "iopub.status.idle": "2022-05-11T21:15:57.197862Z",
     "shell.execute_reply": "2022-05-11T21:15:57.194037Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "name\n",
       "Alice      LinearRegression()\n",
       "Bob        LinearRegression()\n",
       "Charlie    LinearRegression()\n",
       "Dan        LinearRegression()\n",
       "Edith      LinearRegression()\n",
       "                  ...        \n",
       "Victor     LinearRegression()\n",
       "Wendy      LinearRegression()\n",
       "Xavier     LinearRegression()\n",
       "Yvonne     LinearRegression()\n",
       "Zelda      LinearRegression()\n",
       "Name: LinearRegression, Length: 26, dtype: object"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df6 = df5.groupby(\"name\").apply(\n",
    "    train, meta=(\"LinearRegression\", object)\n",
    ").compute()\n",
    "df6"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Further Reading\n",
    "\n",
    "For a more in-depth introduction to Dask dataframes, see the [dask tutorial](https://github.com/dask/dask-tutorial), notebooks 04 and 07."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
